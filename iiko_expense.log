2025-07-02 08:04:30,467 | DEBUG | Using proactor: IocpProactor
2025-07-02 08:04:30,467 | INFO | Запуск выгрузки расхода продуктов для подразделения fa85468e-af74-495e-a33c-37d6562e4699
2025-07-02 08:04:30,578 | DEBUG | connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=20.0 socket_options=None
2025-07-02 08:04:30,607 | DEBUG | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001B70DA60910>
2025-07-02 08:04:30,607 | DEBUG | start_tls.started ssl_context=<ssl.SSLContext object at 0x000001B70D612DC0> server_hostname='pizzayolo.iiko.it' timeout=20.0
2025-07-02 08:04:30,970 | DEBUG | start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001B70DA608E0>
2025-07-02 08:04:30,971 | DEBUG | send_request_headers.started request=<Request [b'POST']>
2025-07-02 08:04:30,971 | DEBUG | send_request_headers.complete
2025-07-02 08:04:30,972 | DEBUG | send_request_body.started request=<Request [b'POST']>
2025-07-02 08:04:30,973 | DEBUG | send_request_body.complete
2025-07-02 08:04:30,973 | DEBUG | receive_response_headers.started request=<Request [b'POST']>
2025-07-02 08:04:31,111 | DEBUG | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Wed, 02 Jul 2025 06:04:30 GMT'), (b'Set-Cookie', b'key=507d602c-cb06-fd5c-88c0-a44651cb57f9; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-07-02 08:04:31,112 | INFO | HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-07-02 08:04:31,112 | DEBUG | receive_response_body.started request=<Request [b'POST']>
2025-07-02 08:04:31,112 | DEBUG | receive_response_body.complete
2025-07-02 08:04:31,113 | DEBUG | response_closed.started
2025-07-02 08:04:31,113 | DEBUG | response_closed.complete
2025-07-02 08:04:31,113 | DEBUG | close.started
2025-07-02 08:04:31,114 | DEBUG | close.complete
2025-07-02 08:04:31,114 | INFO | Запрос к iiko: https://pizzayolo.iiko.it/resto/api/reports/productExpense
2025-07-02 08:04:31,114 | INFO | Параметры: {'key': '507d602c-cb06-fd5c-88c0-a44651cb57f9', 'department': 'fa85468e-af74-495e-a33c-37d6562e4699', 'dateFrom': '01.06.2024', 'dateTo': '30.06.2024', 'hourFrom': -1, 'hourTo': -1}
2025-07-02 08:04:31,121 | DEBUG | connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60.0 socket_options=None
2025-07-02 08:04:31,125 | DEBUG | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001B70DA615A0>
2025-07-02 08:04:31,126 | DEBUG | start_tls.started ssl_context=<ssl.SSLContext object at 0x000001B70D91A7C0> server_hostname='pizzayolo.iiko.it' timeout=60.0
2025-07-02 08:04:31,925 | DEBUG | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001B70DA61C90>
2025-07-02 08:04:31,925 | DEBUG | send_request_headers.started request=<Request [b'GET']>
2025-07-02 08:04:31,926 | DEBUG | send_request_headers.complete
2025-07-02 08:04:31,927 | DEBUG | send_request_body.started request=<Request [b'GET']>
2025-07-02 08:04:31,928 | DEBUG | send_request_body.complete
2025-07-02 08:04:31,928 | DEBUG | receive_response_headers.started request=<Request [b'GET']>
2025-07-02 08:04:57,802 | DEBUG | receive_response_headers.failed exception=CancelledError()
2025-07-02 08:04:57,802 | DEBUG | response_closed.started
2025-07-02 08:04:57,808 | DEBUG | response_closed.complete
2025-07-02 08:04:59,170 | DEBUG | Using proactor: IocpProactor
2025-07-02 08:04:59,171 | INFO | Запуск выгрузки расхода продуктов для подразделения fa85468e-af74-495e-a33c-37d6562e4699
2025-07-02 08:04:59,279 | DEBUG | connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=20.0 socket_options=None
2025-07-02 08:04:59,312 | DEBUG | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000139899108E0>
2025-07-02 08:04:59,312 | DEBUG | start_tls.started ssl_context=<ssl.SSLContext object at 0x00000139894BEDC0> server_hostname='pizzayolo.iiko.it' timeout=20.0
2025-07-02 08:04:59,836 | DEBUG | start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000139899108B0>
2025-07-02 08:04:59,838 | DEBUG | send_request_headers.started request=<Request [b'POST']>
2025-07-02 08:04:59,838 | DEBUG | send_request_headers.complete
2025-07-02 08:04:59,838 | DEBUG | send_request_body.started request=<Request [b'POST']>
2025-07-02 08:04:59,838 | DEBUG | send_request_body.complete
2025-07-02 08:04:59,839 | DEBUG | receive_response_headers.started request=<Request [b'POST']>
2025-07-02 08:04:59,985 | DEBUG | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Wed, 02 Jul 2025 06:04:59 GMT'), (b'Set-Cookie', b'key=67c0774d-258f-3106-c592-8bb663af650d; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-07-02 08:04:59,986 | INFO | HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-07-02 08:04:59,986 | DEBUG | receive_response_body.started request=<Request [b'POST']>
2025-07-02 08:04:59,987 | DEBUG | receive_response_body.complete
2025-07-02 08:04:59,987 | DEBUG | response_closed.started
2025-07-02 08:04:59,987 | DEBUG | response_closed.complete
2025-07-02 08:04:59,987 | DEBUG | close.started
2025-07-02 08:04:59,987 | DEBUG | close.complete
2025-07-02 08:04:59,987 | INFO | Запрос к iiko: https://pizzayolo.iiko.it/resto/api/reports/productExpense
2025-07-02 08:04:59,988 | INFO | Параметры: {'key': '67c0774d-258f-3106-c592-8bb663af650d', 'department': 'fa85468e-af74-495e-a33c-37d6562e4699', 'dateFrom': '30.06.2024', 'dateTo': '30.06.2024', 'hourFrom': -1, 'hourTo': -1}
2025-07-02 08:04:59,994 | DEBUG | connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60.0 socket_options=None
2025-07-02 08:04:59,998 | DEBUG | connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000013989911570>
2025-07-02 08:04:59,999 | DEBUG | start_tls.started ssl_context=<ssl.SSLContext object at 0x00000139897CE7C0> server_hostname='pizzayolo.iiko.it' timeout=60.0
2025-07-02 08:05:00,276 | DEBUG | start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000013989911C60>
2025-07-02 08:05:00,277 | DEBUG | send_request_headers.started request=<Request [b'GET']>
2025-07-02 08:05:00,277 | DEBUG | send_request_headers.complete
2025-07-02 08:05:00,277 | DEBUG | send_request_body.started request=<Request [b'GET']>
2025-07-02 08:05:00,277 | DEBUG | send_request_body.complete
2025-07-02 08:05:00,278 | DEBUG | receive_response_headers.started request=<Request [b'GET']>
2025-07-02 08:05:02,229 | DEBUG | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'5008'), (b'Content-Type', b'application/xml'), (b'Date', b'Wed, 02 Jul 2025 06:05:01 GMT'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-07-02 08:05:02,230 | INFO | HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/productExpense?key=67c0774d-258f-3106-c592-8bb663af650d&department=fa85468e-af74-495e-a33c-37d6562e4699&dateFrom=30.06.2024&dateTo=30.06.2024&hourFrom=-1&hourTo=-1 "HTTP/1.1 200 OK"
2025-07-02 08:05:02,230 | DEBUG | receive_response_body.started request=<Request [b'GET']>
2025-07-02 08:05:02,231 | DEBUG | receive_response_body.complete
2025-07-02 08:05:02,231 | DEBUG | response_closed.started
2025-07-02 08:05:02,231 | DEBUG | response_closed.complete
2025-07-02 08:05:02,231 | INFO | Status code: 200
2025-07-02 08:05:02,232 | DEBUG | Response headers: {'access-control-allow-credentials': 'true', 'access-control-allow-headers': 'origin, content-type, accept, authorization, X-Resto-CorrelationId', 'access-control-allow-methods': 'GET, POST, PUT, DELETE, OPTIONS, HEAD', 'access-control-allow-origin': '*', 'content-encoding': 'gzip', 'content-length': '5008', 'content-type': 'application/xml', 'date': 'Wed, 02 Jul 2025 06:05:01 GMT', 'vary': 'Accept-Encoding', 'strict-transport-security': 'max-age=0; includeSubDomains; preload'}
2025-07-02 08:05:02,232 | INFO | Ответ НЕ json, вероятно XML:
2025-07-02 08:05:02,232 | INFO | <?xml version="1.0" encoding="UTF-8" standalone="yes"?><dayDishValues><dayDishValue><date>30.06.2024</date><productName>Стебель сельдерея</productName><productId>bf73a18c-33ee-4faa-ad16-cc69238d6d75</productId><value>0.024</value></dayDishValue><dayDishValue><date>30.06.2024</date><productName>Салат Айсберг/Романо</productName><productId>d0a9e6c5-fb81-477a-8f6a-90ebaeed92b6</productId><value>0.770</value></dayDishValue><dayDishValue><date>30.06.2024</date><productName>Мед</productName><productId
2025-07-02 08:05:02,233 | DEBUG | close.started
2025-07-02 08:05:02,233 | DEBUG | close.complete
2025-07-02 08:05:02,234 | INFO | Финальный ответ (обрезка):
2025-07-02 08:05:02,234 | INFO | <?xml version="1.0" encoding="UTF-8" standalone="yes"?><dayDishValues><dayDishValue><date>30.06.2024</date><productName>Стебель сельдерея</productName><productId>bf73a18c-33ee-4faa-ad16-cc69238d6d75</productId><value>0.024</value></dayDishValue><dayDishValue><date>30.06.2024</date><productName>Салат Айсберг/Романо</productName><productId>d0a9e6c5-fb81-477a-8f6a-90ebaeed92b6</productId><value>0.770</value></dayDishValue><dayDishValue><date>30.06.2024</date><productName>Мед</productName><productId>7b5f6eb6-e4e0-403f-95f2-3cddea83761a</productId><value>0.006</value></dayDishValue><dayDishValue><date>30.06.2024</date><productName>Перец черный молотый</productName><productId>b2fb3008-7a62-448a-957d-c93dc95c0405</productId><value>0.001</value></dayDishValue><dayDishValue><date>30.06.2024</date><productName>Бананы</productName><productId>e819909f-717d-43c5-a2e9-21505a2310f0</productId><value>0.150</value></dayDishValue><dayDishValue><date>30.06.2024</date><productName>Картофель</productName><
2025-07-02 08:06:01,807 | INFO | Выгрузка расхода продуктов по подразделению fa85468e-af74-495e-a33c-37d6562e4699 за 30.06.2024 - 30.06.2024
2025-07-02 08:06:02,387 | INFO | HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-07-02 08:06:02,387 | INFO | Запрос к iiko: https://pizzayolo.iiko.it/resto/api/reports/productExpense
2025-07-02 08:06:02,388 | INFO | Параметры: {'key': 'b72d9abc-7b2e-59aa-e6ec-4d09d34df409', 'department': 'fa85468e-af74-495e-a33c-37d6562e4699', 'dateFrom': '30.06.2024', 'dateTo': '30.06.2024', 'hourFrom': -1, 'hourTo': -1}
2025-07-02 08:06:04,646 | INFO | HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/productExpense?key=b72d9abc-7b2e-59aa-e6ec-4d09d34df409&department=fa85468e-af74-495e-a33c-37d6562e4699&dateFrom=30.06.2024&dateTo=30.06.2024&hourFrom=-1&hourTo=-1 "HTTP/1.1 200 OK"
2025-07-02 08:06:04,687 | INFO | Status code: 200
2025-07-02 08:06:04,688 | INFO | Ответ (первые 500 символов):
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><dayDishValues><dayDishValue><date>30.06.2024</date><productName>Стебель сельдерея</productName><productId>bf73a18c-33ee-4faa-ad16-cc69238d6d75</productId><value>0.024</value></dayDishValue><dayDishValue><date>30.06.2024</date><productName>Салат Айсберг/Романо</productName><productId>d0a9e6c5-fb81-477a-8f6a-90ebaeed92b6</productId><value>0.770</value></dayDishValue><dayDishValue><date>30.06.2024</date><productName>Мед</productName><productId
2025-07-02 08:06:04,692 | INFO | Сконвертировано в DataFrame: 110 строк.
2025-07-02 08:06:05,167 | INFO | Сохранено в product_expense.xlsx
2025-07-02 08:06:16,807 | INFO | Выгрузка расхода продуктов по подразделению fa85468e-af74-495e-a33c-37d6562e4699 за 30.06.2025 - 30.06.2025
2025-07-02 08:06:17,446 | INFO | HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-07-02 08:06:17,447 | INFO | Запрос к iiko: https://pizzayolo.iiko.it/resto/api/reports/productExpense
2025-07-02 08:06:17,448 | INFO | Параметры: {'key': '24d3f738-6a46-ee21-ab11-44ee1cb660a5', 'department': 'fa85468e-af74-495e-a33c-37d6562e4699', 'dateFrom': '30.06.2025', 'dateTo': '30.06.2025', 'hourFrom': -1, 'hourTo': -1}
2025-07-02 08:06:26,739 | INFO | HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/productExpense?key=24d3f738-6a46-ee21-ab11-44ee1cb660a5&department=fa85468e-af74-495e-a33c-37d6562e4699&dateFrom=30.06.2025&dateTo=30.06.2025&hourFrom=-1&hourTo=-1 "HTTP/1.1 200 OK"
2025-07-02 08:06:27,178 | INFO | Status code: 200
2025-07-02 08:06:27,179 | INFO | Ответ (первые 500 символов):
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><dayDishValues><dayDishValue><date>30.06.2025</date><productName>Перец чили</productName><productId>c7217531-2b31-450c-9743-ca1b075a9ccc</productId><value>0.004</value></dayDishValue><dayDishValue><date>30.06.2025</date><productName>Салат Айсберг/Романо</productName><productId>d0a9e6c5-fb81-477a-8f6a-90ebaeed92b6</productId><value>6.397</value></dayDishValue><dayDishValue><date>30.06.2025</date><productName>Мед</productName><productId>7b5f6e
2025-07-02 08:06:27,180 | INFO | Сконвертировано в DataFrame: 161 строк.
2025-07-02 08:06:27,488 | INFO | Сохранено в product_expense.xlsx
