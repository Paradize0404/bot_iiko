2025-06-22 12:45:46,795 - DEBUG - Using proactor: IocpProactor
2025-06-22 12:45:46,890 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-22 12:45:46,911 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000024D32F35630>
2025-06-22 12:45:46,911 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000024D32C0F340> server_hostname='pizzayolo.iiko.it' timeout=5.0
2025-06-22 12:45:48,515 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000024D32F35600>
2025-06-22 12:45:48,516 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-22 12:45:48,517 - DEBUG - send_request_headers.complete
2025-06-22 12:45:48,517 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-22 12:45:48,518 - DEBUG - send_request_body.complete
2025-06-22 12:45:48,518 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-22 12:45:48,648 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Sun, 22 Jun 2025 10:45:48 GMT'), (b'Set-Cookie', b'key=34b1acc3-7f59-1723-a115-6d4d1ec41c76; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 12:45:48,648 - INFO - HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-06-22 12:45:48,649 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-22 12:45:48,649 - DEBUG - receive_response_body.complete
2025-06-22 12:45:48,649 - DEBUG - response_closed.started
2025-06-22 12:45:48,649 - DEBUG - response_closed.complete
2025-06-22 12:45:48,650 - DEBUG - close.started
2025-06-22 12:45:48,650 - DEBUG - close.complete
2025-06-22 12:45:48,665 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60 socket_options=None
2025-06-22 12:45:48,670 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000024D32F35420>
2025-06-22 12:45:48,670 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000024D32E9F340> server_hostname='pizzayolo.iiko.it' timeout=60
2025-06-22 12:45:50,569 - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000024D32F37100>
2025-06-22 12:45:50,570 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-22 12:45:50,570 - DEBUG - send_request_headers.complete
2025-06-22 12:45:50,571 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-22 12:45:50,571 - DEBUG - send_request_body.complete
2025-06-22 12:45:50,571 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-22 12:45:56,339 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Type', b'application/xml'), (b'Date', b'Sun, 22 Jun 2025 10:45:56 GMT'), (b'Vary', b'Accept-Encoding'), (b'Transfer-Encoding', b'chunked'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 12:45:56,339 - INFO - HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/olap?key=34b1acc3-7f59-1723-a115-6d4d1ec41c76&report=SALES&from=01.05.2025&to=31.05.2025&summary=true&O=r&D=e&groupRow=WaiterName&groupRow=OpenTime&groupRow=CloseTime&groupRow=CookingPlace&groupRow=DeletedWithWriteoff&groupRow=OrderDeleted&groupRow=DishCategory&groupRow=PayTypes.Combo&groupRow=OrderNum&agr=DishDiscountSumInt&agr=ProductCostBase.ProductCost&agr=DishSumInt "HTTP/1.1 200 OK"
2025-06-22 12:45:56,339 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-22 12:46:12,930 - DEBUG - receive_response_body.complete
2025-06-22 12:46:12,930 - DEBUG - response_closed.started
2025-06-22 12:46:12,931 - DEBUG - response_closed.complete
2025-06-22 12:46:13,369 - DEBUG - close.started
2025-06-22 12:46:13,370 - DEBUG - close.complete
2025-06-22 12:50:33,875 - DEBUG - Using proactor: IocpProactor
2025-06-22 12:50:33,877 - INFO - Получаем OLAP-отчет по продажам
2025-06-22 12:50:34,007 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=5.0 socket_options=None
2025-06-22 12:50:34,014 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002277FD017E0>
2025-06-22 12:50:34,014 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002277F9DF440> server_hostname='pizzayolo.iiko.it' timeout=5.0
2025-06-22 12:50:39,020 - DEBUG - start_tls.failed exception=ConnectTimeout(TimeoutError('_ssl.c:990: The handshake operation timed out'))
2025-06-22 12:52:07,813 - DEBUG - Using proactor: IocpProactor
2025-06-22 12:52:07,813 - INFO - Получаем OLAP-отчет по продажам
2025-06-22 12:52:07,916 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=20.0 socket_options=None
2025-06-22 12:52:08,441 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000027ED4441870>
2025-06-22 12:52:08,441 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000027ED411F4C0> server_hostname='pizzayolo.iiko.it' timeout=20.0
2025-06-22 12:52:10,268 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000027ED4441840>
2025-06-22 12:52:10,268 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-22 12:52:10,269 - DEBUG - send_request_headers.complete
2025-06-22 12:52:10,269 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-22 12:52:10,269 - DEBUG - send_request_body.complete
2025-06-22 12:52:10,269 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-22 12:52:10,724 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Sun, 22 Jun 2025 10:52:10 GMT'), (b'Set-Cookie', b'key=ce7b3ae7-30a8-3cb9-51c5-37a87505cd36; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 12:52:10,725 - INFO - HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-06-22 12:52:10,725 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-22 12:52:10,725 - DEBUG - receive_response_body.complete
2025-06-22 12:52:10,726 - DEBUG - response_closed.started
2025-06-22 12:52:10,726 - DEBUG - response_closed.complete
2025-06-22 12:52:10,726 - DEBUG - close.started
2025-06-22 12:52:10,726 - DEBUG - close.complete
2025-06-22 12:52:10,752 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60 socket_options=None
2025-06-22 12:52:10,757 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000027ED44416C0>
2025-06-22 12:52:10,757 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000027ED43AF3C0> server_hostname='pizzayolo.iiko.it' timeout=60
2025-06-22 12:52:11,966 - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000027ED4443370>
2025-06-22 12:52:11,967 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-22 12:52:11,967 - DEBUG - send_request_headers.complete
2025-06-22 12:52:11,967 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-22 12:52:11,967 - DEBUG - send_request_body.complete
2025-06-22 12:52:11,967 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-22 12:52:17,829 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Type', b'application/xml'), (b'Date', b'Sun, 22 Jun 2025 10:52:17 GMT'), (b'Vary', b'Accept-Encoding'), (b'Transfer-Encoding', b'chunked'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 12:52:17,829 - INFO - HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/olap?key=ce7b3ae7-30a8-3cb9-51c5-37a87505cd36&report=SALES&from=01.05.2025&to=31.05.2025&summary=true&O=r&D=e&groupRow=WaiterName&groupRow=OpenTime&groupRow=CloseTime&groupRow=CookingPlace&groupRow=DeletedWithWriteoff&groupRow=OrderDeleted&groupRow=DishCategory&groupRow=PayTypes.Combo&groupRow=OrderNum&agr=DishDiscountSumInt&agr=ProductCostBase.ProductCost&agr=DishSumInt "HTTP/1.1 200 OK"
2025-06-22 12:52:17,829 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-22 12:52:36,127 - DEBUG - receive_response_body.complete
2025-06-22 12:52:36,128 - DEBUG - response_closed.started
2025-06-22 12:52:36,128 - DEBUG - response_closed.complete
2025-06-22 12:52:36,563 - DEBUG - close.started
2025-06-22 12:52:36,564 - DEBUG - close.complete
2025-06-22 12:52:36,599 - DEBUG - Данные загружены в DataFrame
2025-06-22 12:52:36,611 - INFO - После фильтрации осталось 13441 строк
2025-06-22 12:52:36,721 - INFO - Скрипт завершил работу успешно.
2025-06-22 12:54:58,538 - DEBUG - Using proactor: IocpProactor
2025-06-22 12:54:58,539 - INFO - Получаем OLAP-отчет по продажам
2025-06-22 12:54:58,646 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=20.0 socket_options=None
2025-06-22 12:54:58,669 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000028C37BD1870>
2025-06-22 12:54:58,669 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000028C378AF3C0> server_hostname='pizzayolo.iiko.it' timeout=20.0
2025-06-22 12:54:59,717 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000028C37BD1840>
2025-06-22 12:54:59,717 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-22 12:54:59,718 - DEBUG - send_request_headers.complete
2025-06-22 12:54:59,718 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-22 12:54:59,718 - DEBUG - send_request_body.complete
2025-06-22 12:54:59,718 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-22 12:54:59,945 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Sun, 22 Jun 2025 10:55:00 GMT'), (b'Set-Cookie', b'key=23560775-5f46-69ff-0853-02dc3c73a05b; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 12:54:59,947 - INFO - HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-06-22 12:54:59,947 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-22 12:54:59,947 - DEBUG - receive_response_body.complete
2025-06-22 12:54:59,947 - DEBUG - response_closed.started
2025-06-22 12:54:59,947 - DEBUG - response_closed.complete
2025-06-22 12:54:59,948 - DEBUG - close.started
2025-06-22 12:54:59,948 - DEBUG - close.complete
2025-06-22 12:54:59,966 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60 socket_options=None
2025-06-22 12:54:59,970 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000028C37BD14E0>
2025-06-22 12:54:59,970 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000028C37B3F3C0> server_hostname='pizzayolo.iiko.it' timeout=60
2025-06-22 12:55:00,974 - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x0000028C37BD3340>
2025-06-22 12:55:00,975 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-22 12:55:00,975 - DEBUG - send_request_headers.complete
2025-06-22 12:55:00,975 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-22 12:55:00,975 - DEBUG - send_request_body.complete
2025-06-22 12:55:00,976 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-22 12:55:05,578 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Type', b'application/xml'), (b'Date', b'Sun, 22 Jun 2025 10:55:05 GMT'), (b'Vary', b'Accept-Encoding'), (b'Transfer-Encoding', b'chunked'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 12:55:05,578 - INFO - HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/olap?key=23560775-5f46-69ff-0853-02dc3c73a05b&report=SALES&from=01.05.2025&to=31.05.2025&summary=true&O=r&D=e&groupRow=OpenTime&groupRow=CookingPlace&groupRow=DeletedWithWriteoff&groupRow=OrderDeleted&groupRow=DishCategory&groupRow=PayTypes.Combo&groupRow=OrderNum&agr=DishDiscountSumInt&agr=ProductCostBase.ProductCost&agr=DishSumInt "HTTP/1.1 200 OK"
2025-06-22 12:55:05,579 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-22 12:55:09,329 - DEBUG - receive_response_body.complete
2025-06-22 12:55:09,329 - DEBUG - response_closed.started
2025-06-22 12:55:09,330 - DEBUG - response_closed.complete
2025-06-22 12:55:09,696 - DEBUG - close.started
2025-06-22 12:55:09,696 - DEBUG - close.complete
2025-06-22 12:55:09,723 - DEBUG - Данные загружены в DataFrame
2025-06-22 12:55:09,733 - INFO - После фильтрации осталось 13434 строк
2025-06-22 12:55:09,841 - INFO - Скрипт завершил работу успешно.
2025-06-22 12:56:17,153 - DEBUG - Using proactor: IocpProactor
2025-06-22 12:56:17,154 - INFO - Получаем OLAP-отчет по продажам
2025-06-22 12:56:17,261 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=20.0 socket_options=None
2025-06-22 12:56:17,286 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000210F2501840>
2025-06-22 12:56:17,287 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000210F21DF3C0> server_hostname='pizzayolo.iiko.it' timeout=20.0
2025-06-22 12:56:20,655 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000210F2501810>
2025-06-22 12:56:20,655 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-22 12:56:20,656 - DEBUG - send_request_headers.complete
2025-06-22 12:56:20,656 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-22 12:56:20,657 - DEBUG - send_request_body.complete
2025-06-22 12:56:20,657 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-22 12:56:20,825 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Sun, 22 Jun 2025 10:56:20 GMT'), (b'Set-Cookie', b'key=72a677b1-8917-cbb7-b93e-bc30cb11fba1; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 12:56:20,826 - INFO - HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-06-22 12:56:20,826 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-22 12:56:20,828 - DEBUG - receive_response_body.complete
2025-06-22 12:56:20,828 - DEBUG - response_closed.started
2025-06-22 12:56:20,828 - DEBUG - response_closed.complete
2025-06-22 12:56:20,828 - DEBUG - close.started
2025-06-22 12:56:20,829 - DEBUG - close.complete
2025-06-22 12:56:20,844 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60 socket_options=None
2025-06-22 12:56:20,847 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x00000210F25014B0>
2025-06-22 12:56:20,849 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000210F246F3C0> server_hostname='pizzayolo.iiko.it' timeout=60
2025-06-22 12:56:23,955 - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x00000210F2503310>
2025-06-22 12:56:23,956 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-22 12:56:23,956 - DEBUG - send_request_headers.complete
2025-06-22 12:56:23,957 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-22 12:56:23,958 - DEBUG - send_request_body.complete
2025-06-22 12:56:23,958 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-22 12:56:28,504 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Type', b'application/xml'), (b'Date', b'Sun, 22 Jun 2025 10:56:28 GMT'), (b'Vary', b'Accept-Encoding'), (b'Transfer-Encoding', b'chunked'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 12:56:28,504 - INFO - HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/olap?key=72a677b1-8917-cbb7-b93e-bc30cb11fba1&report=SALES&from=01.05.2025&to=31.05.2025&summary=true&O=r&D=e&groupRow=OpenTime&groupRow=CookingPlace&groupRow=DeletedWithWriteoff&groupRow=OrderDeleted&groupRow=DishCategory&groupRow=PayTypes.Combo&groupRow=OrderNum&agr=DishDiscountSumInt&agr=ProductCostBase.ProductCost&agr=DishSumInt "HTTP/1.1 200 OK"
2025-06-22 12:56:28,505 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-22 12:56:49,087 - DEBUG - receive_response_body.complete
2025-06-22 12:56:49,087 - DEBUG - response_closed.started
2025-06-22 12:56:49,088 - DEBUG - response_closed.complete
2025-06-22 12:56:49,455 - DEBUG - close.started
2025-06-22 12:56:49,456 - DEBUG - close.complete
2025-06-22 12:56:49,481 - DEBUG - Данные загружены в DataFrame
2025-06-22 12:56:49,491 - INFO - После фильтрации осталось 13434 строк
2025-06-22 12:56:49,599 - INFO - Скрипт завершил работу успешно.
2025-06-22 13:02:31,330 - DEBUG - Using proactor: IocpProactor
2025-06-22 13:02:31,331 - INFO - Получаем OLAP-отчет по продажам
2025-06-22 13:02:31,438 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=20.0 socket_options=None
2025-06-22 13:02:31,995 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001CC8A9F1990>
2025-06-22 13:02:31,995 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001CC8A6CF3C0> server_hostname='pizzayolo.iiko.it' timeout=20.0
2025-06-22 13:02:33,546 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001CC8A9F1960>
2025-06-22 13:02:33,547 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-22 13:02:33,547 - DEBUG - send_request_headers.complete
2025-06-22 13:02:33,547 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-22 13:02:33,547 - DEBUG - send_request_body.complete
2025-06-22 13:02:33,547 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-22 13:02:33,749 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Sun, 22 Jun 2025 11:02:33 GMT'), (b'Set-Cookie', b'key=ac242795-e9b4-8c44-7e81-55f129d214d4; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:02:33,750 - INFO - HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-06-22 13:02:33,750 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-22 13:02:33,750 - DEBUG - receive_response_body.complete
2025-06-22 13:02:33,751 - DEBUG - response_closed.started
2025-06-22 13:02:33,751 - DEBUG - response_closed.complete
2025-06-22 13:02:33,751 - DEBUG - close.started
2025-06-22 13:02:33,752 - DEBUG - close.complete
2025-06-22 13:02:33,767 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60 socket_options=None
2025-06-22 13:02:33,770 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001CC8A9F1600>
2025-06-22 13:02:33,771 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001CC8A95F3C0> server_hostname='pizzayolo.iiko.it' timeout=60
2025-06-22 13:02:34,655 - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001CC8A9F3460>
2025-06-22 13:02:34,655 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-22 13:02:34,656 - DEBUG - send_request_headers.complete
2025-06-22 13:02:34,656 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-22 13:02:34,656 - DEBUG - send_request_body.complete
2025-06-22 13:02:34,656 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-22 13:02:39,229 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Type', b'application/xml'), (b'Date', b'Sun, 22 Jun 2025 11:02:39 GMT'), (b'Vary', b'Accept-Encoding'), (b'Transfer-Encoding', b'chunked'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:02:39,229 - INFO - HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/olap?key=ac242795-e9b4-8c44-7e81-55f129d214d4&report=SALES&from=01.05.2025&to=31.05.2025&summary=true&O=r&D=e&groupRow=OpenTime&groupRow=CookingPlace&groupRow=DeletedWithWriteoff&groupRow=OrderDeleted&groupRow=DishCategory&groupRow=PayTypes.Combo&groupRow=OrderNum&agr=DishDiscountSumInt&agr=ProductCostBase.ProductCost&agr=DishSumInt "HTTP/1.1 200 OK"
2025-06-22 13:02:39,230 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-22 13:02:51,099 - DEBUG - receive_response_body.complete
2025-06-22 13:02:51,099 - DEBUG - response_closed.started
2025-06-22 13:02:51,099 - DEBUG - response_closed.complete
2025-06-22 13:02:51,465 - DEBUG - close.started
2025-06-22 13:02:51,466 - DEBUG - close.complete
2025-06-22 13:02:51,492 - DEBUG - Данные загружены в DataFrame
2025-06-22 13:02:51,502 - INFO - После фильтрации осталось 13434 строк
2025-06-22 13:02:51,611 - INFO - Скрипт завершил работу успешно.
2025-06-22 13:04:47,447 - DEBUG - Using proactor: IocpProactor
2025-06-22 13:04:47,449 - INFO - Получаем OLAP-отчет по продажам
2025-06-22 13:04:47,551 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=20.0 socket_options=None
2025-06-22 13:04:47,572 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001CB52501930>
2025-06-22 13:04:47,572 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001CB521DF3C0> server_hostname='pizzayolo.iiko.it' timeout=20.0
2025-06-22 13:04:50,492 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001CB52501900>
2025-06-22 13:04:50,492 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-22 13:04:50,493 - DEBUG - send_request_headers.complete
2025-06-22 13:04:50,494 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-22 13:04:50,494 - DEBUG - send_request_body.complete
2025-06-22 13:04:50,494 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-22 13:04:50,794 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Sun, 22 Jun 2025 11:04:50 GMT'), (b'Set-Cookie', b'key=b961e5a3-046e-73ee-59d9-56c34332f0d7; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:04:50,795 - INFO - HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-06-22 13:04:50,795 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-22 13:04:50,796 - DEBUG - receive_response_body.complete
2025-06-22 13:04:50,796 - DEBUG - response_closed.started
2025-06-22 13:04:50,796 - DEBUG - response_closed.complete
2025-06-22 13:04:50,796 - DEBUG - close.started
2025-06-22 13:04:50,797 - DEBUG - close.complete
2025-06-22 13:04:50,812 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60 socket_options=None
2025-06-22 13:04:50,815 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001CB525015A0>
2025-06-22 13:04:50,816 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001CB5246F3C0> server_hostname='pizzayolo.iiko.it' timeout=60
2025-06-22 13:04:52,050 - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001CB52503400>
2025-06-22 13:04:52,052 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-22 13:04:52,052 - DEBUG - send_request_headers.complete
2025-06-22 13:04:52,052 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-22 13:04:52,052 - DEBUG - send_request_body.complete
2025-06-22 13:04:52,053 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-22 13:04:56,688 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Type', b'application/xml'), (b'Date', b'Sun, 22 Jun 2025 11:04:56 GMT'), (b'Vary', b'Accept-Encoding'), (b'Transfer-Encoding', b'chunked'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:04:56,689 - INFO - HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/olap?key=b961e5a3-046e-73ee-59d9-56c34332f0d7&report=SALES&from=01.05.2025&to=31.05.2025&summary=true&O=r&D=e&groupRow=OpenTime&groupRow=CookingPlace&groupRow=DeletedWithWriteoff&groupRow=OrderDeleted&groupRow=DishCategory&groupRow=PayTypes.Combo&groupRow=OrderNum&agr=DishDiscountSumInt&agr=ProductCostBase.ProductCost&agr=DishSumInt "HTTP/1.1 200 OK"
2025-06-22 13:04:56,689 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-22 13:05:15,545 - DEBUG - receive_response_body.complete
2025-06-22 13:05:15,545 - DEBUG - response_closed.started
2025-06-22 13:05:15,545 - DEBUG - response_closed.complete
2025-06-22 13:05:15,916 - DEBUG - close.started
2025-06-22 13:05:15,917 - DEBUG - close.complete
2025-06-22 13:05:15,944 - DEBUG - Данные загружены в DataFrame
2025-06-22 13:05:15,953 - INFO - После фильтрации осталось 13434 строк
2025-06-22 13:05:16,062 - INFO - Скрипт завершил работу успешно.
2025-06-22 13:07:48,544 - DEBUG - Using proactor: IocpProactor
2025-06-22 13:07:48,545 - INFO - Получаем OLAP-отчет по продажам
2025-06-22 13:07:48,637 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=20.0 socket_options=None
2025-06-22 13:07:48,662 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002294E7FDF30>
2025-06-22 13:07:48,663 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002294E4DF4C0> server_hostname='pizzayolo.iiko.it' timeout=20.0
2025-06-22 13:07:49,617 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002294E7FDF00>
2025-06-22 13:07:49,617 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-22 13:07:49,617 - DEBUG - send_request_headers.complete
2025-06-22 13:07:49,618 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-22 13:07:49,618 - DEBUG - send_request_body.complete
2025-06-22 13:07:49,618 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-22 13:07:49,822 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Sun, 22 Jun 2025 11:07:49 GMT'), (b'Set-Cookie', b'key=3e6442d8-7ab0-a957-dda6-85b99650f7cf; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:07:49,824 - INFO - HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-06-22 13:07:49,824 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-22 13:07:49,824 - DEBUG - receive_response_body.complete
2025-06-22 13:07:49,825 - DEBUG - response_closed.started
2025-06-22 13:07:49,825 - DEBUG - response_closed.complete
2025-06-22 13:07:49,825 - DEBUG - close.started
2025-06-22 13:07:49,826 - DEBUG - close.complete
2025-06-22 13:07:49,841 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60 socket_options=None
2025-06-22 13:07:49,846 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000002294E7FDCC0>
2025-06-22 13:07:49,846 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002294E76F4C0> server_hostname='pizzayolo.iiko.it' timeout=60
2025-06-22 13:07:51,333 - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000002294E7FFA00>
2025-06-22 13:07:51,334 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-22 13:07:51,334 - DEBUG - send_request_headers.complete
2025-06-22 13:07:51,335 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-22 13:07:51,335 - DEBUG - send_request_body.complete
2025-06-22 13:07:51,335 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-22 13:08:05,346 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Type', b'application/xml'), (b'Date', b'Sun, 22 Jun 2025 11:07:56 GMT'), (b'Vary', b'Accept-Encoding'), (b'Transfer-Encoding', b'chunked'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:08:05,346 - INFO - HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/olap?key=3e6442d8-7ab0-a957-dda6-85b99650f7cf&report=SALES&from=01.05.2025&to=31.05.2025&summary=true&O=r&D=e&groupRow=OpenTime&groupRow=CookingPlace&groupRow=DeletedWithWriteoff&groupRow=OrderDeleted&groupRow=DishCategory&groupRow=PayTypes.Combo&groupRow=OrderNum&agr=DishDiscountSumInt&agr=ProductCostBase.ProductCost&agr=DishSumInt "HTTP/1.1 200 OK"
2025-06-22 13:08:05,347 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-22 13:08:30,370 - DEBUG - receive_response_body.complete
2025-06-22 13:08:30,370 - DEBUG - response_closed.started
2025-06-22 13:08:30,370 - DEBUG - response_closed.complete
2025-06-22 13:08:30,741 - DEBUG - close.started
2025-06-22 13:08:30,741 - DEBUG - close.complete
2025-06-22 13:08:30,766 - DEBUG - Данные загружены в DataFrame
2025-06-22 13:08:30,777 - INFO - После фильтрации осталось 13434 строк
2025-06-22 13:08:30,903 - INFO - Скрипт завершил работу успешно.
2025-06-22 13:10:37,164 - DEBUG - Using proactor: IocpProactor
2025-06-22 13:10:37,165 - INFO - Получаем OLAP-отчет по продажам
2025-06-22 13:10:37,265 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=20.0 socket_options=None
2025-06-22 13:10:37,289 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002F4A6AEDFF0>
2025-06-22 13:10:37,289 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002F4A67D3540> server_hostname='pizzayolo.iiko.it' timeout=20.0
2025-06-22 13:10:39,884 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002F4A6AEDFC0>
2025-06-22 13:10:39,885 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-22 13:10:39,885 - DEBUG - send_request_headers.complete
2025-06-22 13:10:39,886 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-22 13:10:39,886 - DEBUG - send_request_body.complete
2025-06-22 13:10:39,886 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-22 13:10:40,053 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Sun, 22 Jun 2025 11:10:40 GMT'), (b'Set-Cookie', b'key=6da2c17f-b579-6289-ea8b-4129d5bbc905; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:10:40,054 - INFO - HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-06-22 13:10:40,055 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-22 13:10:40,055 - DEBUG - receive_response_body.complete
2025-06-22 13:10:40,055 - DEBUG - response_closed.started
2025-06-22 13:10:40,055 - DEBUG - response_closed.complete
2025-06-22 13:10:40,056 - DEBUG - close.started
2025-06-22 13:10:40,056 - DEBUG - close.complete
2025-06-22 13:10:40,072 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60 socket_options=None
2025-06-22 13:10:40,076 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000002F4A6AEDD80>
2025-06-22 13:10:40,076 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002F4A6A23540> server_hostname='pizzayolo.iiko.it' timeout=60
2025-06-22 13:10:41,794 - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000002F4A6AEFA90>
2025-06-22 13:10:41,795 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-22 13:10:41,795 - DEBUG - send_request_headers.complete
2025-06-22 13:10:41,795 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-22 13:10:41,795 - DEBUG - send_request_body.complete
2025-06-22 13:10:41,795 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-22 13:10:46,342 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Type', b'application/xml'), (b'Date', b'Sun, 22 Jun 2025 11:10:46 GMT'), (b'Vary', b'Accept-Encoding'), (b'Transfer-Encoding', b'chunked'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:10:46,343 - INFO - HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/olap?key=6da2c17f-b579-6289-ea8b-4129d5bbc905&report=SALES&from=01.05.2025&to=31.05.2025&summary=true&O=r&D=e&groupRow=OpenTime&groupRow=CookingPlace&groupRow=DeletedWithWriteoff&groupRow=OrderDeleted&groupRow=DishCategory&groupRow=PayTypes.Combo&groupRow=OrderNum&agr=DishDiscountSumInt&agr=ProductCostBase.ProductCost&agr=DishSumInt "HTTP/1.1 200 OK"
2025-06-22 13:10:46,343 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-22 13:10:58,612 - DEBUG - receive_response_body.complete
2025-06-22 13:10:58,613 - DEBUG - response_closed.started
2025-06-22 13:10:58,613 - DEBUG - response_closed.complete
2025-06-22 13:10:58,980 - DEBUG - close.started
2025-06-22 13:10:58,980 - DEBUG - close.complete
2025-06-22 13:10:59,007 - DEBUG - Данные загружены в DataFrame
2025-06-22 13:10:59,016 - INFO - После фильтрации осталось 13434 строк
2025-06-22 13:10:59,143 - INFO - Скрипт завершил работу успешно.
2025-06-22 13:12:25,256 - DEBUG - Using proactor: IocpProactor
2025-06-22 13:12:25,258 - INFO - Получаем OLAP-отчет по продажам
2025-06-22 13:12:25,362 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=20.0 socket_options=None
2025-06-22 13:12:25,392 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001844D26E170>
2025-06-22 13:12:25,392 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001844CF534C0> server_hostname='pizzayolo.iiko.it' timeout=20.0
2025-06-22 13:12:26,797 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001844D26E140>
2025-06-22 13:12:26,798 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-22 13:12:26,798 - DEBUG - send_request_headers.complete
2025-06-22 13:12:26,798 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-22 13:12:26,799 - DEBUG - send_request_body.complete
2025-06-22 13:12:26,799 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-22 13:12:26,977 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Sun, 22 Jun 2025 11:12:27 GMT'), (b'Set-Cookie', b'key=3af372e1-902e-e8f9-e65a-22a84d4d8b72; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:12:26,978 - INFO - HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-06-22 13:12:26,979 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-22 13:12:26,979 - DEBUG - receive_response_body.complete
2025-06-22 13:12:26,979 - DEBUG - response_closed.started
2025-06-22 13:12:26,979 - DEBUG - response_closed.complete
2025-06-22 13:12:26,980 - DEBUG - close.started
2025-06-22 13:12:26,980 - DEBUG - close.complete
2025-06-22 13:12:26,996 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60 socket_options=None
2025-06-22 13:12:27,000 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001844D26DF00>
2025-06-22 13:12:27,001 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001844D1DF4C0> server_hostname='pizzayolo.iiko.it' timeout=60
2025-06-22 13:12:28,592 - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001844D26FC10>
2025-06-22 13:12:28,593 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-22 13:12:28,593 - DEBUG - send_request_headers.complete
2025-06-22 13:12:28,594 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-22 13:12:28,594 - DEBUG - send_request_body.complete
2025-06-22 13:12:28,594 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-22 13:12:33,006 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Type', b'application/xml'), (b'Date', b'Sun, 22 Jun 2025 11:12:33 GMT'), (b'Vary', b'Accept-Encoding'), (b'Transfer-Encoding', b'chunked'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:12:33,007 - INFO - HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/olap?key=3af372e1-902e-e8f9-e65a-22a84d4d8b72&report=SALES&from=01.05.2025&to=31.05.2025&summary=true&O=r&D=e&groupRow=OpenTime&groupRow=CookingPlace&groupRow=DeletedWithWriteoff&groupRow=OrderDeleted&groupRow=DishCategory&groupRow=PayTypes.Combo&groupRow=OrderNum&agr=DishDiscountSumInt&agr=ProductCostBase.ProductCost&agr=DishSumInt "HTTP/1.1 200 OK"
2025-06-22 13:12:33,007 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-22 13:12:35,122 - DEBUG - receive_response_body.complete
2025-06-22 13:12:35,122 - DEBUG - response_closed.started
2025-06-22 13:12:35,123 - DEBUG - response_closed.complete
2025-06-22 13:12:35,493 - DEBUG - close.started
2025-06-22 13:12:35,494 - DEBUG - close.complete
2025-06-22 13:12:35,520 - DEBUG - Данные загружены в DataFrame
2025-06-22 13:12:35,531 - INFO - После фильтрации осталось 13434 строк
2025-06-22 13:12:35,657 - INFO - Скрипт завершил работу успешно.
2025-06-22 13:15:15,369 - DEBUG - Using proactor: IocpProactor
2025-06-22 13:15:15,370 - INFO - Получаем OLAP-отчет по продажам
2025-06-22 13:15:15,460 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=20.0 socket_options=None
2025-06-22 13:15:15,485 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002420BC42590>
2025-06-22 13:15:15,485 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002420B9534C0> server_hostname='pizzayolo.iiko.it' timeout=20.0
2025-06-22 13:15:23,187 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002420BC42560>
2025-06-22 13:15:23,188 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-22 13:15:23,188 - DEBUG - send_request_headers.complete
2025-06-22 13:15:23,189 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-22 13:15:23,189 - DEBUG - send_request_body.complete
2025-06-22 13:15:23,189 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-22 13:15:23,343 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Sun, 22 Jun 2025 11:15:23 GMT'), (b'Set-Cookie', b'key=053d3a93-1dbf-6c1f-8c6b-687f76accc3e; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:15:23,343 - INFO - HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-06-22 13:15:23,344 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-22 13:15:23,344 - DEBUG - receive_response_body.complete
2025-06-22 13:15:23,344 - DEBUG - response_closed.started
2025-06-22 13:15:23,345 - DEBUG - response_closed.complete
2025-06-22 13:15:23,345 - DEBUG - close.started
2025-06-22 13:15:23,345 - DEBUG - close.complete
2025-06-22 13:15:23,362 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60 socket_options=None
2025-06-22 13:15:23,366 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000002420BC42860>
2025-06-22 13:15:23,366 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002420BBBF4C0> server_hostname='pizzayolo.iiko.it' timeout=60
2025-06-22 13:15:25,238 - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000002420BC431F0>
2025-06-22 13:15:25,238 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-22 13:15:25,239 - DEBUG - send_request_headers.complete
2025-06-22 13:15:25,239 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-22 13:15:25,239 - DEBUG - send_request_body.complete
2025-06-22 13:15:25,240 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-22 13:15:29,713 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Type', b'application/xml'), (b'Date', b'Sun, 22 Jun 2025 11:15:29 GMT'), (b'Vary', b'Accept-Encoding'), (b'Transfer-Encoding', b'chunked'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:15:29,713 - INFO - HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/olap?key=053d3a93-1dbf-6c1f-8c6b-687f76accc3e&report=SALES&from=01.05.2025&to=31.05.2025&summary=true&O=r&D=e&groupRow=OpenTime&groupRow=CookingPlace&groupRow=DeletedWithWriteoff&groupRow=OrderDeleted&groupRow=DishCategory&groupRow=PayTypes.Combo&groupRow=OrderNum&agr=DishDiscountSumInt&agr=ProductCostBase.ProductCost&agr=DishSumInt "HTTP/1.1 200 OK"
2025-06-22 13:15:29,714 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-22 13:15:45,116 - DEBUG - receive_response_body.complete
2025-06-22 13:15:45,116 - DEBUG - response_closed.started
2025-06-22 13:15:45,117 - DEBUG - response_closed.complete
2025-06-22 13:15:45,483 - DEBUG - close.started
2025-06-22 13:15:45,483 - DEBUG - close.complete
2025-06-22 13:15:45,511 - DEBUG - Данные загружены в DataFrame
2025-06-22 13:15:45,521 - INFO - После фильтрации осталось 13434 строк
2025-06-22 13:15:45,648 - INFO - Скрипт завершил работу успешно.
2025-06-22 13:19:35,877 - DEBUG - Using proactor: IocpProactor
2025-06-22 13:19:35,878 - INFO - Получаем OLAP-отчет по продажам
2025-06-22 13:19:35,979 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=20.0 socket_options=None
2025-06-22 13:19:36,011 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001A32B062560>
2025-06-22 13:19:36,011 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001A32AD534C0> server_hostname='pizzayolo.iiko.it' timeout=20.0
2025-06-22 13:19:40,672 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001A32B062530>
2025-06-22 13:19:40,673 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-06-22 13:19:40,673 - DEBUG - send_request_headers.complete
2025-06-22 13:19:40,673 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-06-22 13:19:40,673 - DEBUG - send_request_body.complete
2025-06-22 13:19:40,673 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-06-22 13:19:41,108 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Length', b'56'), (b'Content-Type', b'text/plain'), (b'Date', b'Sun, 22 Jun 2025 11:19:40 GMT'), (b'Set-Cookie', b'key=e80a423f-f20c-99a6-3769-7dfd886b3791; Secure'), (b'Vary', b'Accept-Encoding'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:19:41,108 - INFO - HTTP Request: POST https://pizzayolo.iiko.it/resto/api/auth "HTTP/1.1 200 OK"
2025-06-22 13:19:41,109 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-06-22 13:19:41,109 - DEBUG - receive_response_body.complete
2025-06-22 13:19:41,109 - DEBUG - response_closed.started
2025-06-22 13:19:41,109 - DEBUG - response_closed.complete
2025-06-22 13:19:41,109 - DEBUG - close.started
2025-06-22 13:19:41,109 - DEBUG - close.complete
2025-06-22 13:19:41,125 - DEBUG - connect_tcp.started host='pizzayolo.iiko.it' port=443 local_address=None timeout=60 socket_options=None
2025-06-22 13:19:41,130 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001A32B062830>
2025-06-22 13:19:41,130 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001A32AFDF4C0> server_hostname='pizzayolo.iiko.it' timeout=60
2025-06-22 13:19:42,602 - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x000001A32B0631C0>
2025-06-22 13:19:42,602 - DEBUG - send_request_headers.started request=<Request [b'GET']>
2025-06-22 13:19:42,603 - DEBUG - send_request_headers.complete
2025-06-22 13:19:42,603 - DEBUG - send_request_body.started request=<Request [b'GET']>
2025-06-22 13:19:42,603 - DEBUG - send_request_body.complete
2025-06-22 13:19:42,603 - DEBUG - receive_response_headers.started request=<Request [b'GET']>
2025-06-22 13:19:47,097 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Access-Control-Allow-Credentials', b'true'), (b'Access-Control-Allow-Headers', b'origin, content-type, accept, authorization, X-Resto-CorrelationId'), (b'Access-Control-Allow-Methods', b'GET, POST, PUT, DELETE, OPTIONS, HEAD'), (b'Access-Control-Allow-Origin', b'*'), (b'Content-Encoding', b'gzip'), (b'Content-Type', b'application/xml'), (b'Date', b'Sun, 22 Jun 2025 11:19:47 GMT'), (b'Vary', b'Accept-Encoding'), (b'Transfer-Encoding', b'chunked'), (b'Strict-Transport-Security', b'max-age=0; includeSubDomains; preload')])
2025-06-22 13:19:47,098 - INFO - HTTP Request: GET https://pizzayolo.iiko.it/resto/api/reports/olap?key=e80a423f-f20c-99a6-3769-7dfd886b3791&report=SALES&from=01.05.2025&to=31.05.2025&summary=true&O=r&D=e&groupRow=OpenTime&groupRow=CookingPlace&groupRow=DeletedWithWriteoff&groupRow=OrderDeleted&groupRow=DishCategory&groupRow=PayTypes.Combo&groupRow=OrderNum&agr=DishDiscountSumInt&agr=ProductCostBase.ProductCost&agr=DishSumInt "HTTP/1.1 200 OK"
2025-06-22 13:19:47,098 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-22 13:19:47,906 - DEBUG - receive_response_body.complete
2025-06-22 13:19:47,906 - DEBUG - response_closed.started
2025-06-22 13:19:47,906 - DEBUG - response_closed.complete
2025-06-22 13:19:48,276 - DEBUG - close.started
2025-06-22 13:19:48,277 - DEBUG - close.complete
2025-06-22 13:19:48,303 - DEBUG - Данные загружены в DataFrame
2025-06-22 13:19:48,314 - INFO - После фильтрации осталось 13434 строк
2025-06-22 13:19:48,438 - INFO - Скрипт завершил работу успешно.
